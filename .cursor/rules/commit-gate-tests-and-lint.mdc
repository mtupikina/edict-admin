---
description: Code cannot be committed until lint passes, coverage ≥90%, and all tests pass
globs: "**/*.ts"
alwaysApply: false
---

# Commit Gate: Lint, Coverage, and Tests

**Code cannot be committed unless all of the following rules are met:**

1. **No linting errors**  
   The code must not cause linting errors. Run `npm run lint` (or `ng lint`) and fix any errors before committing.

2. **Code coverage at least 90%**  
   Run `npm run test:coverage` (or `ng test --watch=false --browsers=ChromeHeadless --code-coverage`). Statements, branches, functions, and lines must each be **at least 90%** for the application source (excluding `main.ts`, `environments`, and test files). Fix or add tests if coverage drops below 90%.

3. **All tests must pass**  
   Run `npm run test` (unit) and `npm run e2e` (Cypress). Every test suite must pass. Fix failing tests before committing.

4. **All new code must be covered by tests**  
   New or changed functionality must have corresponding unit tests (`.spec.ts`) and, where applicable, Cypress e2e coverage. Do not commit new code without test coverage.

**Before every commit:** Run `npm run lint`, then `npm run test:ci` (or `npm run test`), then `npm run test:coverage` to confirm coverage ≥ 90%, then `npm run e2e`. Fix any failures or coverage gaps before committing.

**CI:** The pipeline must run lint, unit tests, coverage, and e2e; the build must fail if lint fails, any test fails, or coverage is below 90%.
