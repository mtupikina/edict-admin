<div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-4">
  <p class="text-slate-600">Assign permissions to roles. Click &quot;Manage permissions&quot; to edit.</p>
  <p-button
    label="Add Role"
    icon="pi pi-plus"
    (onClick)="addRole.emit()"
    styleClass="shadow-soft"
  />
</div>
<div class="bg-white rounded-2xl shadow-soft border border-slate-200/60 overflow-hidden">
  <p-table
    [value]="roles()"
    [loading]="loading()"
    styleClass="p-datatable-sm p-datatable-striped"
    [responsiveLayout]="'scroll'"
  >
    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="name">Name <p-sortIcon field="name" /></th>
        <th>Description</th>
        <th>Actions</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-role>
      <tr>
        <td class="font-medium">
          {{ role.name }}
          @if (role.name === 'super_admin') {
            <span class="ml-2 text-xs text-slate-500 font-normal">(all permissions, cannot be changed)</span>
          }
        </td>
        <td class="text-slate-600">{{ role.description || '—' }}</td>
        <td>
          @if (role.name !== 'super_admin') {
            <div class="flex gap-2">
              <p-button
                label="Manage permissions"
                icon="pi pi-key"
                [outlined]="true"
                size="small"
                (onClick)="managePermissions.emit(role)"
              />
              <p-button
                icon="pi pi-pencil"
                [rounded]="true"
                [text]="true"
                severity="secondary"
                (onClick)="editRole.emit(role)"
                pTooltip="Edit"
                tooltipPosition="top"
              />
              <p-button
                icon="pi pi-trash"
                [rounded]="true"
                [text]="true"
                severity="danger"
                (onClick)="deleteRole.emit({ role, event: $event })"
                pTooltip="Delete"
                tooltipPosition="top"
              />
            </div>
          } @else {
            <span class="text-slate-400 text-sm">—</span>
          }
        </td>
      </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="3" class="text-center py-12 text-slate-500">No roles.</td>
      </tr>
    </ng-template>
  </p-table>
</div>
